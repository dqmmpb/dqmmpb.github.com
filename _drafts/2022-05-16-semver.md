---
layout: post
title:  "Semver"
date:   2022-05-16 09:00:00 +0800
categories: jekyll update
---

## Semver版本号管理

语义化版本控制：采用3个数字：主版本号.次版本号.修订号，版本号递增规则如下：
- 主版本号(major): 当你做了不兼容的 API 修改
- 次版本号(minor): 当你做了向下兼容的功能性新增，可以理解为Feature版本
- 修订号(patch): 当你做了向下兼容的问题修正，可以理解为Bug fix版本

## npm包版本管理

因为`npm`设置了一些规则，可用于在`package.json`文件中选择要将软件包更新到的版本（当运行`npm update`时）。

`npm`的规则使用了如下符号：
- `^`
- `~`
- `>`
- `>=`
- `<`
- `<=`
- `=`
- `-`
- `||`

规则的详情如下：
- `^`: 只会执行不更改最左边非零数字的更新。 如果写入的是`^0.13.0`，则当运行`npm update`时，可以更新到`0.13.1`、`0.13.2`等，但不能更新到`0.14.0`或更高版本。 如果写入的是`^1.13.0`，则当运行`npm update`时，可以更新到`1.13.1`、`1.14.0`等，但不能更新到`2.0.0`或更高版本。
- `~`: 如果写入的是`~0.13.0`，则当运行`npm update`时，会更新到补丁版本：即`0.13.1`可以，但`0.14.0`不可以。
- `>`: 接受高于指定版本的任何版本。
- `>=`: 接受等于或高于指定版本的任何版本。
- `<=`: 接受等于或低于指定版本的任何版本。
- `<`: 接受低于指定版本的任何版本。
- `=`: 接受确切的版本。
- `-`: 接受一定范围的版本。例如：`2.1.0 - 2.6.2`。
- `||`: 组合集合。例如`< 2.1 || > 2.6`。
可以合并其中的一些符号，例如`1.0.0 || >=1.1.0 <1.2.0`，即使用`1.0.0`或从`1.1.0`开始但低于`1.2.0`的版本。

还有其他的规则：

`无符号`: 仅接受指定的特定版本（例如`1.2.1`）。
`latest`: 使用可用的最新版本。

### 前端npm包发布

当发布一个包到npm仓库时，先修改`package.json`为某个版本，然后执行`npm publish`命令。
手动修改版本号的做法需要建立在Semver规范之上，否则可能会造成版本混乱。因此npm提供了相关的命令来更好的遵从Semver规范：
- 升级主版本号：npm version major
- 升级次版本号：npm version minor
- 升级修订号：npm version patch

ps: 上述内容大多引用[npm中使用语义化版本](http://nodejs.cn/learn/semantic-versioning-using-npm)

### 参考资料

- [Semver语义化版本控制](https://semver.org/lang/zh-CN/)
- [前端node-semver工具库](https://github.com/npm/node-semver)
- [npm中使用语义化版本](http://nodejs.cn/learn/semantic-versioning-using-npm)
